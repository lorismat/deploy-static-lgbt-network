import{_ as vt}from"./HeaderViz.194764a4.js";import{_ as wt,a as bt}from"./AuthorCard.d510789a.js";import{_ as Lt,a as Mt}from"./BaseLoader.73feba50.js";import{a as q,l as F,w as rt,b as $t,m as St,e as st,f as O,u as N,h as it,p as jt,q as At,F as Tt,o as at}from"./entry.5e82415a.js";import{s as I,a as R}from"./transform.a53e203a.js";import"./nuxt-link.53277c78.js";import"./_plugin-vue_export-helper.c27b6911.js";class lt extends Map{constructor(e,o=Et){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:o}}),e!=null)for(const[r,s]of e)this.set(r,s)}get(e){return super.get(ut(this,e))}has(e){return super.has(ut(this,e))}set(e,o){return super.set(Bt(this,e),o)}delete(e){return super.delete(Vt(this,e))}}function ut({_intern:n,_key:e},o){const r=e(o);return n.has(r)?n.get(r):o}function Bt({_intern:n,_key:e},o){const r=e(o);return n.has(r)?n.get(r):(n.set(r,o),o)}function Vt({_intern:n,_key:e},o){const r=e(o);return n.has(r)&&(o=n.get(r),n.delete(r)),o}function Et(n){return n!==null&&typeof n=="object"?n.valueOf():n}function Ct(n,e){switch(arguments.length){case 0:break;case 1:this.range(n);break;default:this.range(e).domain(n);break}return this}const ct=Symbol("implicit");function mt(){var n=new lt,e=[],o=[],r=ct;function s(y){let f=n.get(y);if(f===void 0){if(r!==ct)return r;n.set(y,f=e.push(y)-1)}return o[f%o.length]}return s.domain=function(y){if(!arguments.length)return e.slice();e=[],n=new lt;for(const f of y)n.has(f)||n.set(f,e.push(f)-1);return s},s.range=function(y){return arguments.length?(o=Array.from(y),s):o.slice()},s.unknown=function(y){return arguments.length?(r=y,s):r},s.copy=function(){return mt(e,o).unknown(r)},Ct.apply(s,arguments),s}function ft(n,e){let o;if(e===void 0)for(const r of n)r!=null&&(o<r||o===void 0&&r>=r)&&(o=r);else{let r=-1;for(let s of n)(s=e(s,++r,n))!=null&&(o<s||o===void 0&&s>=s)&&(o=s)}return o}function It(n,e){let o;if(e===void 0)for(const r of n)r!=null&&(o>r||o===void 0&&r>=r)&&(o=r);else{let r=-1;for(let s of n)(s=e(s,++r,n))!=null&&(o>s||o===void 0&&s>=s)&&(o=s)}return o}function Y(n,e){let o=0;if(e===void 0)for(let r of n)(r=+r)&&(o+=r);else{let r=-1;for(let s of n)(s=+e(s,++r,n))&&(o+=s)}return o}function kt(n,e){return n.sourceLinks.length?n.depth:e-1}function K(n){return function(){return n}}function dt(n,e){return Q(n.source,e.source)||n.index-e.index}function ht(n,e){return Q(n.target,e.target)||n.index-e.index}function Q(n,e){return n.y0-e.y0}function tt(n){return n.value}function Nt(n){return n.index}function zt(n){return n.nodes}function Dt(n){return n.links}function pt(n,e){const o=n.get(e);if(!o)throw new Error("missing: "+e);return o}function gt({nodes:n}){for(const e of n){let o=e.y0,r=o;for(const s of e.sourceLinks)s.y0=o+s.width/2,o+=s.width;for(const s of e.targetLinks)s.y1=r+s.width/2,r+=s.width}}function Ot(){let n=0,e=0,o=1,r=1,s=24,y=8,f,g=Nt,m=kt,_,x,w=zt,L=Dt,A=6;function p(){const t={nodes:w.apply(null,arguments),links:L.apply(null,arguments)};return $(t),V(t),E(t),c(t),T(t),gt(t),t}p.update=function(t){return gt(t),t},p.nodeId=function(t){return arguments.length?(g=typeof t=="function"?t:K(t),p):g},p.nodeAlign=function(t){return arguments.length?(m=typeof t=="function"?t:K(t),p):m},p.nodeSort=function(t){return arguments.length?(_=t,p):_},p.nodeWidth=function(t){return arguments.length?(s=+t,p):s},p.nodePadding=function(t){return arguments.length?(y=f=+t,p):y},p.nodes=function(t){return arguments.length?(w=typeof t=="function"?t:K(t),p):w},p.links=function(t){return arguments.length?(L=typeof t=="function"?t:K(t),p):L},p.linkSort=function(t){return arguments.length?(x=t,p):x},p.size=function(t){return arguments.length?(n=e=0,o=+t[0],r=+t[1],p):[o-n,r-e]},p.extent=function(t){return arguments.length?(n=+t[0][0],o=+t[1][0],e=+t[0][1],r=+t[1][1],p):[[n,e],[o,r]]},p.iterations=function(t){return arguments.length?(A=+t,p):A};function $({nodes:t,links:a}){for(const[u,i]of t.entries())i.index=u,i.sourceLinks=[],i.targetLinks=[];const l=new Map(t.map((u,i)=>[g(u,i,t),u]));for(const[u,i]of a.entries()){i.index=u;let{source:d,target:h}=i;typeof d!="object"&&(d=i.source=pt(l,d)),typeof h!="object"&&(h=i.target=pt(l,h)),d.sourceLinks.push(i),h.targetLinks.push(i)}if(x!=null)for(const{sourceLinks:u,targetLinks:i}of t)u.sort(x),i.sort(x)}function V({nodes:t}){for(const a of t)a.value=a.fixedValue===void 0?Math.max(Y(a.sourceLinks,tt),Y(a.targetLinks,tt)):a.fixedValue}function E({nodes:t}){const a=t.length;let l=new Set(t),u=new Set,i=0;for(;l.size;){for(const d of l){d.depth=i;for(const{target:h}of d.sourceLinks)u.add(h)}if(++i>a)throw new Error("circular link");l=u,u=new Set}}function c({nodes:t}){const a=t.length;let l=new Set(t),u=new Set,i=0;for(;l.size;){for(const d of l){d.height=i;for(const{source:h}of d.targetLinks)u.add(h)}if(++i>a)throw new Error("circular link");l=u,u=new Set}}function S({nodes:t}){const a=ft(t,i=>i.depth)+1,l=(o-n-s)/(a-1),u=new Array(a);for(const i of t){const d=Math.max(0,Math.min(a-1,Math.floor(m.call(null,i,a))));i.layer=d,i.x0=n+d*l,i.x1=i.x0+s,u[d]?u[d].push(i):u[d]=[i]}if(_)for(const i of u)i.sort(_);return u}function v(t){const a=It(t,l=>(r-e-(l.length-1)*f)/Y(l,tt));for(const l of t){let u=e;for(const i of l){i.y0=u,i.y1=u+i.value*a,u=i.y1+f;for(const d of i.sourceLinks)d.width=d.value*a}u=(r-u+f)/(l.length+1);for(let i=0;i<l.length;++i){const d=l[i];d.y0+=u*(i+1),d.y1+=u*(i+1)}G(l)}}function T(t){const a=S(t);f=Math.min(y,(r-e)/(ft(a,l=>l.length)-1)),v(a);for(let l=0;l<A;++l){const u=Math.pow(.99,l),i=Math.max(1-u,(l+1)/A);U(a,u,i),D(a,u,i)}}function D(t,a,l){for(let u=1,i=t.length;u<i;++u){const d=t[u];for(const h of d){let B=0,b=0;for(const{source:j,value:k}of h.targetLinks){let M=k*(h.layer-j.layer);B+=J(j,h)*M,b+=M}if(!(b>0))continue;let C=(B/b-h.y0)*a;h.y0+=C,h.y1+=C,P(h)}_===void 0&&d.sort(Q),W(d,l)}}function U(t,a,l){for(let u=t.length,i=u-2;i>=0;--i){const d=t[i];for(const h of d){let B=0,b=0;for(const{target:j,value:k}of h.sourceLinks){let M=k*(j.layer-h.layer);B+=X(h,j)*M,b+=M}if(!(b>0))continue;let C=(B/b-h.y0)*a;h.y0+=C,h.y1+=C,P(h)}_===void 0&&d.sort(Q),W(d,l)}}function W(t,a){const l=t.length>>1,u=t[l];Z(t,u.y0-f,l-1,a),H(t,u.y1+f,l+1,a),Z(t,r,t.length-1,a),H(t,e,0,a)}function H(t,a,l,u){for(;l<t.length;++l){const i=t[l],d=(a-i.y0)*u;d>1e-6&&(i.y0+=d,i.y1+=d),a=i.y1+f}}function Z(t,a,l,u){for(;l>=0;--l){const i=t[l],d=(i.y1-a)*u;d>1e-6&&(i.y0-=d,i.y1-=d),a=i.y0-f}}function P({sourceLinks:t,targetLinks:a}){if(x===void 0){for(const{source:{sourceLinks:l}}of a)l.sort(ht);for(const{target:{targetLinks:l}}of t)l.sort(dt)}}function G(t){if(x===void 0)for(const{sourceLinks:a,targetLinks:l}of t)a.sort(ht),l.sort(dt)}function J(t,a){let l=t.y0-(t.sourceLinks.length-1)*f/2;for(const{target:u,width:i}of t.sourceLinks){if(u===a)break;l+=i+f}for(const{source:u,width:i}of a.targetLinks){if(u===t)break;l-=i}return l}function X(t,a){let l=a.y0-(a.targetLinks.length-1)*f/2;for(const{source:u,width:i}of a.targetLinks){if(u===t)break;l+=i+f}for(const{target:u,width:i}of t.sourceLinks){if(u===a)break;l-=i}return l}return p}var nt=Math.PI,et=2*nt,z=1e-6,Pt=et-z;function ot(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function xt(){return new ot}ot.prototype=xt.prototype={constructor:ot,moveTo:function(n,e){this._+="M"+(this._x0=this._x1=+n)+","+(this._y0=this._y1=+e)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(n,e){this._+="L"+(this._x1=+n)+","+(this._y1=+e)},quadraticCurveTo:function(n,e,o,r){this._+="Q"+ +n+","+ +e+","+(this._x1=+o)+","+(this._y1=+r)},bezierCurveTo:function(n,e,o,r,s,y){this._+="C"+ +n+","+ +e+","+ +o+","+ +r+","+(this._x1=+s)+","+(this._y1=+y)},arcTo:function(n,e,o,r,s){n=+n,e=+e,o=+o,r=+r,s=+s;var y=this._x1,f=this._y1,g=o-n,m=r-e,_=y-n,x=f-e,w=_*_+x*x;if(s<0)throw new Error("negative radius: "+s);if(this._x1===null)this._+="M"+(this._x1=n)+","+(this._y1=e);else if(w>z)if(!(Math.abs(x*g-m*_)>z)||!s)this._+="L"+(this._x1=n)+","+(this._y1=e);else{var L=o-y,A=r-f,p=g*g+m*m,$=L*L+A*A,V=Math.sqrt(p),E=Math.sqrt(w),c=s*Math.tan((nt-Math.acos((p+w-$)/(2*V*E)))/2),S=c/E,v=c/V;Math.abs(S-1)>z&&(this._+="L"+(n+S*_)+","+(e+S*x)),this._+="A"+s+","+s+",0,0,"+ +(x*L>_*A)+","+(this._x1=n+v*g)+","+(this._y1=e+v*m)}},arc:function(n,e,o,r,s,y){n=+n,e=+e,o=+o,y=!!y;var f=o*Math.cos(r),g=o*Math.sin(r),m=n+f,_=e+g,x=1^y,w=y?r-s:s-r;if(o<0)throw new Error("negative radius: "+o);this._x1===null?this._+="M"+m+","+_:(Math.abs(this._x1-m)>z||Math.abs(this._y1-_)>z)&&(this._+="L"+m+","+_),o&&(w<0&&(w=w%et+et),w>Pt?this._+="A"+o+","+o+",0,1,"+x+","+(n-f)+","+(e-g)+"A"+o+","+o+",0,1,"+x+","+(this._x1=m)+","+(this._y1=_):w>z&&(this._+="A"+o+","+o+",0,"+ +(w>=nt)+","+x+","+(this._x1=n+o*Math.cos(s))+","+(this._y1=e+o*Math.sin(s))))},rect:function(n,e,o,r){this._+="M"+(this._x0=this._x1=+n)+","+(this._y0=this._y1=+e)+"h"+ +o+"v"+ +r+"h"+-o+"Z"},toString:function(){return this._}};function yt(n){return function(){return n}}function Ft(n){return n[0]}function Ht(n){return n[1]}var qt=Array.prototype.slice;function Rt(n){return n.source}function Kt(n){return n.target}function Qt(n){var e=Rt,o=Kt,r=Ft,s=Ht,y=null;function f(){var g,m=qt.call(arguments),_=e.apply(this,m),x=o.apply(this,m);if(y||(y=g=xt()),n(y,+r.apply(this,(m[0]=_,m)),+s.apply(this,m),+r.apply(this,(m[0]=x,m)),+s.apply(this,m)),g)return y=null,g+""||null}return f.source=function(g){return arguments.length?(e=g,f):e},f.target=function(g){return arguments.length?(o=g,f):o},f.x=function(g){return arguments.length?(r=typeof g=="function"?g:yt(+g),f):r},f.y=function(g){return arguments.length?(s=typeof g=="function"?g:yt(+g),f):s},f.context=function(g){return arguments.length?(y=g??null,f):y},f}function Ut(n,e,o,r,s){n.moveTo(e,o),n.bezierCurveTo(e=(e+r)/2,o,e,s,r,s)}function Wt(){return Qt(Ut)}function Zt(n){return[n.source.x1,n.y0]}function Gt(n){return[n.target.x0,n.y1]}function Jt(){return Wt().source(Zt).target(Gt)}const Xt={key:0},Yt={class:"py-12"},tn=it("div",{id:"sankey"},null,-1),nn=it("div",{class:"py-24"},null,-1),cn={__name:"sankey",setup(n){const e=q("allAuthors"),o=F("block");rt(()=>e.value,(x,w)=>{o.value="none"}),$t(()=>{e.value.length>0&&(o.value="none")});const r=F(""),s=F(""),y=q("peopleDataset"),f=q("sankeyMeetings"),g=F(""),m=F(""),_=q("popupVisible",()=>!1);return rt(()=>r.value,(x,w)=>{if(r.value!=""){const L=y.value.filter(c=>c.ID_1==r.value)[0];s.value={name:L.ID_1,dob:L["Date of birth"],dod:L["Date of death"],occupation:L.Occupation,orientation:L["Sexual orientation"]};let A=f.value.filter(c=>c.participants.includes(r.value)),p=[];A.forEach((c,S)=>{p.push({name:c.city,category:"city"});for(let v=0;v<c.participants.length;v++)c.participants[v]!=r.value&&p.push({name:c.participants[v],category:2})}),p=[...new Map(p.map(c=>[JSON.stringify([c.name,c.category]),c])).values()];let $=[];A.forEach((c,S)=>{for(let v=0;v<c.participants.length;v++)c.participants[v]!=r.value&&($.filter(T=>T.source===c.participants[v]&&T.target===c.city).length>0?($.filter(T=>T.source===c.participants[v]&&T.target===c.city)[0].value+=1,$.filter(T=>T.source===c.participants[v]&&T.target===c.city)[0].meetings.push({dateStart:c.dateStart,dateEnd:c.dateEnd,notes:c.notes,source:c.source,page:c.page,participants:c.participants,dob:c.dob,dod:c.dod,sexuality:c.sexuality,job:c.job,nationality:c.nationality})):$.push({source:c.participants[v],target:c.city,value:1,meetings:[{dateStart:c.dateStart,dateEnd:c.dateEnd,notes:c.notes,source:c.source,page:c.page,participants:c.participants,dob:c.dob,dod:c.dod,sexuality:c.sexuality,job:c.job,nationality:c.nationality}]}))});const V={nodes:p,links:$},E="#e6e6e6";if(I("#sankey").selectAll("*").remove(),$.length>0){let G=function(t,a){I(t.target).attr("stroke","#555"),I(`#text-id-${a.source.index}`).attr("font-weight","bold"),I(`#text-id-${a.target.index}`).attr("font-weight","bold"),R(".node-rect").attr("opacity",.2),I(`#node-id-${a.source.index}`).attr("opacity",1).attr("stroke-opacity",1),I(`#node-id-${a.target.index}`).attr("opacity",1).attr("stroke-opacity",1)},J=function(){R(".paths").attr("stroke",E),R(".text-label").attr("font-weight","regular"),R(".node-rect").attr("opacity",1).attr("stroke-opacity",0)},X=function(t,a){const l=a.source.name,u=a.target.name,i=a.meetings;let d="Meeting";i.length>1&&(d="Meetings"),m.value=`
          ${i.length} ${d} with ${l} in ${u}
        `,g.value="";for(let h=0;h<i.length;h++){let B=i[h].page;B.includes("-")?B="pp. "+B:B="p. "+B;let b=[],C="<br>";for(let k=0;k<i[h].participants.length;k++){b.push({name:i[h].participants[k],dob:i[h].dob[k],dod:i[h].dod[k],nationality:i[h].nationality[k],sexuality:i[h].sexuality[k],job:i[h].job[k]});let M="a",_t="^[aieouAIEOU].*";b[k].nationality.join("/").split("")[0].match(_t)&&(M="an"),C+=`
              ● ${b[k].name} (${b[k].dob} — ${b[k].dod}) was ${M} 
              ${b[k].nationality.join("/")}, ${b[k].sexuality}, ${b[k].job.join(", ")}.
              <br>
            `}let j="";if(i[h].notes!="undefined"){j=": "+i[h].notes,j=j.split("_");const k=[];for(let M=0;M<j.length;M++)k.push(j[M]),M%2==0&&M<j.length-1?k.push("<i>"):M%2==1&&k.push("</i>");j=k.join("")}g.value+=`
            <div class="pb-2 my-2 border-b border-dashed border-gray-500 text-sm">
              <div class="py-2">
                <span class='font-sans font-bold'>${i[h].dateStart} — ${i[h].dateEnd}: </span>
                <span class=''>${j}</span>
              </div>
              <div><span class='font-sans font-bold'>Participants: </span>
                ${C}
              </div>

              <div>
                <br>
                <span class='font-sans font-bold'>Source: </span>
                <span class='italic'>${i[h].source.split("_")[0].split("by")[0]}</span> by <span>${i[h].source.split("_")[0].split("by")[1]}</span>
                (${B})
              </div>
            </div>
          `}_.value=!0},S=0;$.length<6?S=200:$.length<12?S=400:S=800;const v=I("#sankey").append("svg").attr("width",928).attr("height",S).attr("viewBox",[0,0,928,S]).attr("style","max-width: 100%; height: auto; font: 13px sans-serif;"),T=Ot().nodeId(t=>t.name).nodeAlign(kt).nodeWidth(15).nodePadding(10).extent([[1,5],[928-1,S-5]]);let{nodes:D,links:U}=T({nodes:V.nodes.map(t=>Object.assign({},t)),links:V.links.map(t=>Object.assign({},t))});const H=mt(["#736355","#d9d1b8","#401f13"]);D=D.sort(t=>t.category),v.append("g").selectAll().data(D).join("rect").attr("id",t=>`node-id-${t.index}`).attr("x",t=>t.x0).attr("y",t=>t.y0).attr("height",t=>t.y1-t.y0).attr("width",t=>t.x1-t.x0).attr("opacity",1).attr("stroke-width",2).attr("stroke","#000").attr("stroke-opacity",0).attr("class","node-rect").attr("fill",t=>H(t.category)).append("title").text(t=>`${t.name}
${t.value}`);const P=v.append("g").attr("fill","none").attr("stroke-opacity",.9).selectAll().data(U).join("g").style("mix-blend-mode","multiply");P.append("path").attr("d",Jt()).attr("class","paths cursor-pointer").attr("stroke",E).attr("stroke-width",t=>Math.max(3,t.width)).on("click",X).on("mouseout",J).on("mouseover",G),P.append("title").text(t=>`${t.source.name} → ${t.target.name}
${t.value}`),v.append("g").selectAll().data(D).join("text").attr("class","text-label").attr("id",t=>`text-id-${t.index}`).attr("x",t=>t.x0<928/2?t.x1+6:t.x0-6).attr("y",t=>(t.y1+t.y0)/2).attr("dy","0.35em").attr("text-anchor",t=>t.x0<928/2?"start":"end").text(t=>t.name)}else{const c=`
        <div>No meetings registered for ${r.value}</div>
      `;I("#sankey").html(c)}}}),(x,w)=>{const L=vt,A=wt,p=Mt,$=Lt,V=St("FormKit"),E=bt;return at(),st(Tt,null,[O(L),O(A,{description:N(g),title:N(m)},null,8,["description","title"]),O(p,{title:"Sankey-Diagram for Author Meetings",part1:`
    If you select an author from the drop-down menu below, it will generate a diagram of all their meetings with other LGBTQ+ exile writers organized according to location.
    If you click on a particular connection, a pop-up box will give you further information about the meetings that took place between writers in a given location.
    `}),O($,{displayLoader:N(o),padding:"py-44"},null,8,["displayLoader"]),N(o)!="block"?(at(),st("div",Xt,[it("div",Yt,[O(V,{modelValue:N(r),"onUpdate:modelValue":w[0]||(w[0]=c=>jt(r)?r.value=c:null),type:"select",label:"Select an Author",name:"author","inner-class":"ring-0 focus-within:ring-gray-500",options:N(e)},null,8,["modelValue","options"]),O(E,{authorInfo:N(s)},null,8,["authorInfo"])]),tn,nn])):At("",!0)],64)}}};export{cn as default};
