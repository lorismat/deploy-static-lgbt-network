import{_ as D}from"./HeaderViz.194764a4.js";import{_ as A,a as B}from"./BaseLoader.73feba50.js";import{a as d,l as h,w as M,b as $,s as N,e as V,f as g,u as z,F as T,h as x,o as j}from"./entry.5e82415a.js";import"./nuxt-link.53277c78.js";const F=x("div",{class:"py-12"},[x("div",{id:"map"})],-1),H={__name:"map-meetings",setup(E){const y=d("allAuthors"),m=h("block");M(()=>y.value,(l,i)=>{m.value="none",_(f.value,L,u)}),$(()=>{y.value.length>0&&(m.value="none")});const b=N(),v=d("counterMapMeeting"),f=d("mapMeetingsDataset"),k=d("peopleDataset");let u;const c=h(),S=h();M(()=>v.value,(l,i)=>{v.value>0&&_(f.value,L,u)});function _(l,i,p){c.value!=null&&(p.removeLayer(c.value),c.value=i.markerClusterGroup({spiderLegPolylineOptions:{weight:0},icon:S.value,polygonOptions:{fillColor:"transparent",color:"#fff",opacity:0},iconCreateFunction:function(r){const e=Math.max(30,Math.min(7*r.getChildCount(),100));return i.divIcon({html:r.getChildCount(),className:"mycluster",iconSize:i.point(e,e)})}}));for(let r=0;r<l.length;r++){const e=f.value[r];if(e.lat!=null&&e.lon!=null){let w="",C=[];for(let n=0;n<e.participants.length;n++){let s="<span class='font-bold'>Participants:</span><br>";for(let a=0;a<e.participants[n].length;a++){const t=k.value.filter(o=>o.ID_1===e.participants[n][a])[0];if(t!=null){let o="a",O="^[aieouAIEOU].*";t.Nationality!=null&&t.Nationality.join("/").split("")[0].match(O)&&(o="an"),s+="• "+t.ID_1+` (${t["Date of birth"]} — ${t["Date of death"]}) was ${o} ${t.Nationality!=null?t.Nationality.join("/"):""}, <span class=''>${t["Sexual orientation"]}</span>, ${t.Occupation!=null?t.Occupation.join(", "):""}<br>`}}C.push(s)}for(let n=0;n<e.notes.length;n++){let s=e.page[n];s.includes("-")?s="pp. "+s:s="p. "+s;let a="";if(e.notes[n]!="undefined"){a=": "+e.notes[n],a=a.split("_");const t=[];for(let o=0;o<a.length;o++)t.push(a[o]),o%2==0&&o<a.length-1?t.push("<i>"):o%2==1&&t.push("</i>");a=t.join("")}w+=`
          <div class='border-b border-dotted border-gray-600 pb-1 pt-4 px-2'>
            <span class='font-bold'>${e.dateStart[n]} — ${e.dateEnd[n]}:</span> ${a}
            <br><br>
            ${C[n]}
            <br><br>
            <span class='font-bold'>Source:</span> <span class='italic'>${e.source[n].split("_")[0].split("by")[0]}</span> by <span>${e.source[n].split("_")[0].split("by")[1]}</span>
            (${s})
          </div>
        `}const I=`
        <h2 class='text-md font-bold p-2 border-b border-gray-400'>Meetings in ${e.city} <span class='font-normal'>(${e.count})</span></h2>
        <div class='px-0 py-0'>
          <p>${w}</p>
        </div>
        <!-- <p>${e.count} meetings</p> -->
      `;c.value.addLayer(i.marker([e.lat,e.lon]).bindPopup(I))}}p.addLayer(c.value)}return $(()=>{u=L.map("map").setView(b.map.center,b.map.zoomInit),L.tileLayer("https://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}{r}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',maxZoom:10,minZoom:2,ext:"png"}).addTo(u),L.tileLayer("https://stamen-tiles-{s}.a.ssl.fastly.net/toner-labels/{z}/{x}/{y}{r}.{ext}",{attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',maxZoom:10,minZoom:8,ext:"png"}).addTo(u);const l=L.icon({iconUrl:"/images/marker.png",iconSize:[20,30],iconAnchor:[2,25],popupAnchor:[6,-30]});L.Marker.mergeOptions({icon:l}),c.value=L.markerClusterGroup({spiderLegPolylineOptions:{weight:0},icon:l,polygonOptions:{fillColor:"transparent",color:"#fff",opacity:0},iconCreateFunction:function(i){const p=Math.max(30,Math.min(7*i.getChildCount(),100));return L.divIcon({html:i.getChildCount(),className:"mycluster",iconSize:L.point(p,p)})}})}),(l,i)=>{const p=D,r=B,e=A;return j(),V(T,null,[g(p),g(r,{title:"Map of Author Meetings",part1:`
    This interactive map plots meetings between LGBTQ+ exile writers across the globe. The numbers in the icons indicate the number of locations where these meetings took place in different parts of the world. If you select an icon, they will divide ever more precisely according to location. If you click on an individual location icon, a pop-up box will give you further information about the meetings between writers that took place in the given location.
    `}),g(e,{displayLoader:z(m),padding:"py-6"},null,8,["displayLoader"]),F],64)}}};export{H as default};
